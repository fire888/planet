!function(){"use strict";var e={uniforms:{tDiffuse:{value:null},light:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#ifdef GL_ES","precision mediump float;","#endif","uniform sampler2D tDiffuse;","uniform float light;","varying vec2 vUv;","float point (in vec2 uv, in vec2 center, in float radius) {","float len = length(center - uv);","return float(1. - smoothstep(radius, radius + .6, len));","}","void main() {","vec2 uv = vUv;","vec4 diff = texture2D(tDiffuse, uv);","vec2 tileuv = vec2(uv.x, uv.y*0.8) * 180.;","float radius = .03;","vec2 center = floor( tileuv ) + vec2( 0.5, 0.5 );","float point = point( tileuv, center, radius );","vec4 points = vec4( 1.5 * light - 0.2, 1.5 * light - 0.2, 1.8 * light,  (1.01 - diff.y) * point );","vec4 contur = vec4( 1.2*light, 1.2*light, 1.8*light,  diff.x );","vec4 continents = vec4( .1, .1, .2, (1.5 - diff.y) * (1.0 - points.z) * 0.01 );","gl_FragColor = contur + continents + points;","}"].join("\n")},n={uniforms:{viewVector:{value:new THREE.Vector3(-800,0,1800)},light:{value:.01},glowColor:{value:new THREE.Vector3(.5,.5,.9)}},vertexShader:["uniform vec3 viewVector;","uniform float light;","varying float intensity;","void main() {","vec3 vNormal = normalize( normalMatrix * normal );","vec3 vNormel = normalize( normalMatrix * viewVector );","intensity = pow( abs(light) - dot(vNormal, vNormel), 2.9 );","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 glowColor;","varying float intensity;","void main() {","vec3 glow = glowColor * intensity;","gl_FragColor = vec4( glow, 1.0 );","}"].join("\n")},t={uniforms:{light:{value:1}},vertexShader:["uniform float light;","void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float light;","void main() {","gl_FragColor = vec4( 0.8*light, 0.9*light, 1.3*light, 1.0 );","}"].join("\n")},i=void 0,o=function(){var e=document.getElementById("App-webGL"),n=e.clientWidth||e.offsetWidth;return n>window.innerWidth&&(n=window.innerWidth),n},r=function(e){i=e,window.addEventListener("resize",function(){i(o())},!1)},a=void 0,s=function(e){a=e,document.addEventListener("wheel",u,!1),document.addEventListener("scroll",u,!1),document.addEventListener("touchstart",u,!1)},u=function(){a(),l(),setTimeout(function(){document.getElementById("slogan").className="show"},500)},l=function(){document.removeEventListener("wheel",u,!1),document.removeEventListener("scroll",u,!1),document.removeEventListener("touchstart",u,!1)},c=function(){document.getElementById("webGL").className="show"},d=function(){var e=document.getElementById("preloader");e.className="hide",setTimeout(function(){e.className="hidden"},1e3)};window.onload=function(){p(function(){var e=o();H(e),r(M),j(),k(),y(),c(),d(),s(f)})};var m="DARK",f=function(){return m="FLASH"},v=function(){"FLASH"==m&&C()&&ne()&&(m="LIGHT"),V(m),Z(m)},h=void 0,E=void 0,g={textures:{sceneBack:null,waterNormals:null,continents:null,clouds:null},geoms:{corpus:null,diod:null}},p=function(e){h=new THREE.TextureLoader,E=new THREE.OBJLoader,new Promise(function(e){g.textures.sceneBack=h.load("assets/background_map.jpg",function(){e()})}).then(function(){return new Promise(function(e){g.textures.waterNormals=h.load("assets/Voda_normali.jpg",function(n){n.wrapS=n.wrapT=THREE.RepeatWrapping,n.repeat.set(5,5),e()})})}).then(function(){return new Promise(function(e){g.textures.continents=h.load("assets/contour.jpg",function(){e()})})}).then(function(){return new Promise(function(e){g.textures.clouds=h.load("assets/clouds.jpg",function(){e()})})}).then(function(){return new Promise(function(e){E.load("assets/connector.obj",function(n){n.traverse(function(n){n instanceof THREE.Mesh==1&&("diod"==n.name&&(g.geoms.diod=n.geometry),"iron"==n.name&&(g.geoms.corpus=n.geometry),g.geoms.diod&&g.geoms.corpus&&e())})})})}).then(function(){h=null,E=null,e()})},w=void 0,R=void 0,T=void 0,H=function(e){T=new THREE.WebGLRenderer({alpha:!0,canvas:document.getElementById("webGL")}),T.setPixelRatio(window.devicePixelRatio),T.setSize(e,.7*e),R=new THREE.PerspectiveCamera(75,e/(.7*e),3.5,15e3),R.position.set(-800,-200,2200);var n=new THREE.PointLight(16777215,2);n.position.set(1e3,1e3,1e3);var t=new THREE.AmbientLight(16777215,.2);w=new THREE.Scene,w.background=g.textures.sceneBack,w.add(n,t)},M=function(e){T.setSize(e,.7*e),R.aspect=e/(.7*e),R.updateProjectionMatrix()},y=function e(){v(),T.render(w,R),requestAnimationFrame(e)},x=void 0,P=void 0,S=void 0,L=void 0,D=void 0,j=function(){L=B(),P=G(),S=b(),D=A(),x=new THREE.Group,w.add(x.add(S,P,D),L)},G=function(){return new THREE.Mesh(new THREE.SphereGeometry(600,40,40),new THREE.MeshPhongMaterial({map:g.textures.waterNormals,normalMap:g.textures.waterNormals,shininess:0,transparent:!0,opacity:.94,color:2042436}))},b=function(){var n=new THREE.Mesh(new THREE.SphereGeometry(608,40,40),new THREE.ShaderMaterial(e));return n.rotation.z=-.5,n.rotation.x=-.5,n.material.transparent=!0,n.material.side=THREE.DoubleSide,n.material.depthWrite=!1,n.material.needsUpdate=!0,n.material.uniforms.tDiffuse.value=g.textures.continents,n},A=function(){return new THREE.Mesh(new THREE.SphereGeometry(616,40,40),new THREE.MeshPhongMaterial({color:14540287,alphaMap:g.textures.clouds,shininess:0,transparent:!0,depthWrite:!1}))},B=function(){var e=new THREE.Mesh(new THREE.SphereGeometry(780,40,40),new THREE.ShaderMaterial(n));return e.material.transparent=!0,e.material.blending=THREE.AdditiveBlending,e.material.side=THREE.DoubleSide,e.material.depthWrite=!1,e.material.needsUpdate=!0,e},N=.002,z="left",V=function(e){x&&("DARK"==e&&W(),"FLASH"==e&&_(),x.rotation.y+=N)},W=function(){N>.008&&"left"==z&&(z="right"),N<-.008&&"right"==z&&(z="left"),"left"==z&&(N+=3e-4),"right"==z&&(N-=3e-4)},_=function(){S&&L&&(N<.02?N+=1e-4:N=.02,S.material.uniforms.light.value<1.35&&(S.material.uniforms.light.value+=.012,L.material.uniforms.light.value+=.0034))},C=function(){return!x||.02==N},F=[],I=void 0,U=void 0,k=function(){I=new THREE.Group,w.add(I);var e=K();U=X();for(var n=0;n<7;n++){var t=Math.cos(n/7*Math.PI*2+.2),i=Math.sin(n/7*Math.PI*2+.2),o=Y(e,t,i),r={wire:o.mesh,plug:q(e,t,i),arrPoints:o.arrPoints,arrDistancePoints:o.arrDistancePoints,dirX:t,dirY:i};I.add(r.plug,r.wire),F.push(r)}},K=function(){return new THREE.MeshPhongMaterial({color:789017,emissive:0,specular:12632256,shininess:100})},X=function(){return new THREE.ShaderMaterial(t)},Y=function(e,n,t){for(var i=[],o=[],r=0;r<6;r++)i.push(new THREE.Vector3((100*Math.random()-50+700*n)*r+770*n,(100*Math.random()-50+700*t)*r+770*t,(100*Math.random()-50)*r)),o.push([(10*Math.random()-5)*r,(10*Math.random()-5)*r,(10*Math.random()-5)*r]);var a=new THREE.SplineCurve3(i),s=new THREE.TubeBufferGeometry(a,300,20,3,!1);return s.dynamic=!0,{mesh:new THREE.Mesh(s,e),arrPoints:i,arrDistancePoints:o}},q=function(e,n,t){var i=new THREE.Mesh(g.geoms.corpus,e),o=new THREE.Mesh(g.geoms.diod,U),r=new THREE.Group;return r.add(o,i),r.position.set(770*n,770*t,0),r.lookAt(0,0,0),r},J=function(){0!=F.length&&(w.remove(I),F=[])},O=3.5,Q=0,Z=function(e){0!=F.length&&("DARK"==e&&$(),"FLASH"==e&&ee())},$=function(){if(2==Q)return Q=0;Q++;var e=Date.now();F.forEach(function(n){n.plug&&n.wire&&(n.wire.geometry.parameters.path.points.forEach(function(t,i){t.x=n.arrPoints[i].x+n.arrDistancePoints[i][0]*Math.sin(.0018*e),t.y=n.arrPoints[i].y+n.arrDistancePoints[i][1]*Math.sin(.0035*e),n.plug.position.x<0?t.z=n.arrPoints[i].z+n.arrDistancePoints[i][2]*Math.sin(.0021*e)-1e3*N*i:t.z=n.arrPoints[i].z+n.arrDistancePoints[i][2]*Math.sin(.0021*e)+1e3*N*i}),n.wire.geometry.copy(new THREE.TubeBufferGeometry(n.wire.geometry.parameters.path,300,20,3,!1)),n.wire.geometry.needsUpdate=!0)}),x&&(I.rotation.y=x.rotation.y)},ee=function(){U.uniforms.light.value-=.01,O+=.3,F.forEach(function(e){if(e.plug&&e.wire){var n=e.dirX*O,t=e.dirY*O;e.plug.position.x+=n,e.plug.position.y+=t,e.wire.position.x+=n,e.wire.position.y+=t}})},ne=function(){return 0==F.length||(!F[0].plug||F[0].plug.position.x>3e3&&(J(),!0))}}();
