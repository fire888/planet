!function(){"use strict";function e(e){var n=e.getBoundingClientRect(),i=Math.max(document.documentElement.clientHeight,window.innerHeight);return!(n.bottom<0||n.top-i>=0)}function n(e){o(function(){a(ge),i(),e()})}function i(){h=setInterval(t,30)}function t(){for(var e in ge)r(ge[e].canvas)&&d(ge[e])}function r(e){var n=e.getBoundingClientRect(),i=Math.max(document.documentElement.clientHeight,window.innerHeight);return!(n.bottom<0||n.top-i>=0)}function o(e){for(var n in ge)!function(e){for(var n in ge[e].imgs)!function(n){ye.push(function(){ge[e].imgs[n].data=new Image,ge[e].imgs[n].data.src=ge[e].imgs[n].src,ge[e].imgs[n].data.onload=function(){Ee++,ye[Ee]()}})}(n)}(n);for(var i in we)!function(e){ye.push(function(){we[e].data=new Image,we[e].data.src=we[e].src,we[e].data.onload=function(){Ee++,ye[Ee]()}})}(i);ye.push(function(){e()}),ye[0]()}function a(e){for(var n in e)e[n].canvas=document.getElementById(n),e[n].ctx=e[n].canvas.getContext("2d"),s(n,e[n])}function s(e,n){"dr01"==e&&(n.sprites.push(l("LinesVert",5)),n.sprites.push(l("LinesHor",2))),"dr02"==e&&(n.sprites.push(l("LeftNORMslow",70)),n.sprites.push(l("RightBAD",10))),"dr03"==e&&(n.sprites.push(l("LeftCONUS",70)),n.sprites.push(l("RightCONUS",70))),"dr04"==e&&(n.sprites.push(l("LeftCONUS",50)),n.sprites.push(l("LeftCONUSred",50)),n.sprites.push(l("LeftCONUSgreen",50)),n.sprites.push(l("RightCONUS",50)),n.sprites.push(l("RightCONUSred",50)),n.sprites.push(l("RightCONUSgreen",50))),"dr05"==e&&(n.sprites.push(l("LeftCONUSSuperSprT",70)),n.sprites.push(l("LeftCONUSSuperSprB",70)),n.sprites.push(l("RightCONUSSuperSprT",70)),n.sprites.push(l("RightCONUSSuperSprB",70)))}function l(e,n){for(var i=[],t=0;t<n;t++){var r={};u(r,e),i.push(r)}return i}function u(e,n){var i=me[n],t=30*Math.random()+30;e.type=n,e.x=Math.random()*(i.start.xMax-i.start.xMin)+i.start.xMin,e.y=Math.random()*(i.start.yMax-i.start.yMin)+i.start.yMin,e.spdX=(i.finish.xMin-e.x)/t*i.spd,e.spdY=(i.finish.yMin-e.y+Math.random()*(i.finish.yMax-i.finish.yMin)*i.conus)/t*i.spd}function d(e){e.ctx.clearRect(0,0,e.canvas.width,e.canvas.height),e.ctx.globalCompositeOperation="source-over",e.ctx.drawImage(e.imgs.back.data,0,0,e.canvas.width,e.canvas.height),c(e),e.imgs.wire&&e.ctx.drawImage(e.imgs.wire.data,e.imgs.wire.x,e.imgs.wire.y,e.imgs.wire.x2,e.imgs.wire.y2),e.ctx.globalCompositeOperation="destination-in",e.ctx.drawImage(e.imgs.back.data,0,0,e.canvas.width,e.canvas.height)}function c(e){for(var n=0;n<e.sprites.length;n++)for(var i=0;i<e.sprites[n].length;i++)f(e.ctx,e.sprites[n][i])}function f(e,n){var i=me[n.type];if(n.x>i.finish.xMin&&u(n,n.type),"LinesHor"==n.type&&n.y<i.finish.yMin&&u(n,n.type),n.x+=n.spdX,n.y+=n.spdY,"LinesVert"==n.type||"LinesHor"==n.type)return void e.drawImage(we[n.type].data,n.x,n.y);e.fillStyle=me[n.type].color,e.fillRect(n.x,n.y,7,7)}var h,x={uniforms:{red:{value:0},green:{value:.021},blue:{value:.04},tDiffuse:{value:null},light:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#ifdef GL_ES","precision mediump float;","#endif","uniform float red;","uniform float green;","uniform float blue;","uniform sampler2D tDiffuse;","uniform float light;","varying vec2 vUv;","float point (in vec2 uv, in vec2 center, in float radius) {","float len = length(center - uv);","return float(1. - smoothstep(radius, radius + .6, len));","}","void main() {","vec2 uv = vUv;","vec4 diff = texture2D(tDiffuse, uv);","vec2 tileuv = vec2(uv.x, uv.y*0.8) * 180.;","float radius = .03;","vec2 center = floor( tileuv ) + vec2( 0.5, 0.5 );","float point = point( tileuv, center, radius );","vec4 points = vec4( red + light, green + light, blue + light,  (1.01 - diff.y) * point );","vec4 contur = vec4( red + light, green + light, blue + light,  diff.x );","vec4 continents = vec4( red, green, blue, (1.5 - diff.y) * (1.0 - points.z) * 0.01 );","gl_FragColor = contur + continents + points;","}"].join("\n")},p={uniforms:{viewVector:{value:new THREE.Vector3(-800,-200,8200)},light:{value:.3},glowColor:{value:new THREE.Vector3(0,.24,.47)},border:{value:3.3}},vertexShader:["uniform vec3 viewVector;","uniform float light;","uniform float border;","varying float intensity;","void main() {","vec3 vNormal = normalize( normalMatrix * normal );","vec3 vNormel = normalize( normalMatrix * viewVector );","intensity = pow( abs(light) - dot(vNormal, vNormel), border );","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 glowColor;","uniform float light;","varying float intensity;","void main() {","vec3 glow = ( glowColor + light ) * intensity;","gl_FragColor = vec4( glow, 1.0 );","}"].join("\n")},v={uniforms:{color:{value:new THREE.Vector3(1.5,1.5,1.9)},light:{value:1}},vertexShader:["uniform float light;","void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float light;","uniform vec3 color;","void main() {","gl_FragColor = vec4( color * light, 1.0 );","}"].join("\n")},M={earthRed:0,earthGreen:.04,earthBlue:.08,glowRed:0,glowGreen:.19,glowBlue:.22,glowLight:0,glowBorder:2.9,wireColor:"#ffae23",wireDiodRed:.9,wireDiodGreen:.9,wireDiodBlue:.9,earthLeftMax:-2,earthRightMax:.45,earthAxell:85e-5,earthMaxSpd:.017,earthSpdFree:.015},g=function(){V()},m="DARK",w=function(){return m="FLASH"},y=function(){"FLASH"==m&&Q()&&xe()&&(m="LIGHT"),Z(m),de(m),Me(m)},E=void 0,R=void 0,S={textures:{waterNormals:null,continents:null},geoms:{corpus:null,diod:null}},H=function(e){E=new THREE.TextureLoader,R=new THREE.OBJLoader,new Promise(function(e){S.textures.continents=E.load("assets/contour.jpg",function(){e()})}).then(function(){return new Promise(function(e){R.load("assets/connector.obj",function(n){n.traverse(function(n){n instanceof THREE.Mesh==1&&("diod"==n.name&&(S.geoms.diod=n.geometry),"iron"==n.name&&(S.geoms.corpus=n.geometry),S.geoms.diod&&S.geoms.corpus&&e())})})})}).then(function(){E=null,R=null,e()})},T=void 0,L=void 0,b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{canvas:"none..",w:window.innerWidth,h:window.innerHeight},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{canvas:"none..",w:window.innerWidth,h:window.innerHeight};T=e.canvas,L=n.canvas,_(),A(e),D(n),ve(),k(),ie(),G(e,n)},C=void 0,N=void 0,U=void 0,O=void 0,B=void 0,_=function(){var e=new THREE.PointLight(252791645,.2);e.position.set(1e3,3e3,600);var n=new THREE.AmbientLight(9046131,.2);C=new THREE.Scene,C.add(e,n),C.add(new THREE.Mesh(new THREE.CubeGeometry(500,500,500),new THREE.MeshBasicMaterial({color:65535})))},A=function(e){U=new THREE.WebGLRenderer({canvas:e.canvas}),N=new THREE.PerspectiveCamera(20,e.w/e.h,3.5,15e3),N.position.set(-800,-200,8200)},D=function(e){O=new THREE.WebGLRenderer({canvas:e.canvas}),B=new THREE.PerspectiveCamera(20,e.w/e.h,3.5,15e3),B.position.set(0,-2e3,-4e3),B.rotation.x=1.1,O.render(C,B)},G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{w:window.innerWidth,h:window.innerHeight},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{w:window.innerWidth,h:window.innerHeight};U.setSize(e.w,e.h),N.aspect=e.w/e.h,N.updateProjectionMatrix(),O.setSize(n.w,n.h),B.aspect=n.w/n.h,B.updateProjectionMatrix()},V=function n(){var i=e(T),t=e(L);(i||t)&&y(),i&&U.render(C,N),t&&O.render(C,B),requestAnimationFrame(n)},W=void 0,I=void 0,j=void 0,k=function(){j=P(),I=F(),W=new THREE.Group,W.rotation.z=-.3,W.rotation.x=.5,I.rotation.y=.7,C.add(W.add(I),j)},F=function(){var e=new THREE.Mesh(new THREE.SphereGeometry(608,40,40),new THREE.ShaderMaterial(x));return e.material.transparent=!0,e.material.side=THREE.DoubleSide,e.material.depthWrite=!1,e.material.needsUpdate=!0,e.material.uniforms.tDiffuse.value=S.textures.continents,e},P=function(){var e=new THREE.Mesh(new THREE.SphereGeometry(780,40,40),new THREE.ShaderMaterial(p));return e.material.transparent=!0,e.material.blending=THREE.AdditiveBlending,e.material.side=THREE.DoubleSide,e.material.depthWrite=!1,e.material.needsUpdate=!0,e},z=.002,Y="left",Z=function(e){W&&("DARK"==e&&K(),"FLASH"==e&&q(),I.rotation.y+=z)},K=function(){I.rotation.y>M.earthLeftMax&&"left"==Y&&(Y="right"),I.rotation.y<M.earthRightMax&&"right"==Y&&(Y="left"),"left"==Y&&Math.abs(z+M.earthAxell)<M.earthMaxSpd&&(z+=M.earthAxell),"right"==Y&&Math.abs(z-M.earthAxell)<M.earthMaxSpd&&(z-=M.earthAxell)},q=function(){z<M.earthSpdFree?z+=3e-4:z=M.earthSpdFree,I.material.uniforms.light.value<1.35&&(I.material.uniforms.light.value+=.012),j.material.uniforms.light.value<.1&&(j.material.uniforms.light.value+=.0034)},Q=function(){return z==M.earthSpdFree},X=[],J=[{dirY:6.08,dirZ:.8},{dirY:.2,dirZ:1.8},{dirY:3.24,dirZ:.8},{dirY:1.5,dirZ:.8},{dirY:1.9,dirZ:1.8},{dirY:3.7,dirZ:2}],$=void 0,ee=void 0,ne=void 0,ie=function(){ee=te(),ne=re(),$=new THREE.Group,J.forEach(function(e){var n=oe(),i=ae();n.plug.add(i);var t=new THREE.Group;t.add(n.plug),t.position.set(Math.sin(e.dirZ)*Math.sin(e.dirY)*795,795*Math.cos(e.dirZ),Math.sin(e.dirZ)*Math.cos(e.dirY)*795),t.lookAt(0,0,0),X.push({connector:t,plug:n.plug,corpus:n.corpus,diod:n.diod,wire:i}),$.add(t)}),I.add($)},te=function(){return new THREE.MeshPhongMaterial({color:789017,emissive:0,specular:16777215,shininess:100})},re=function(){return new THREE.ShaderMaterial(v)},oe=function(){var e=new THREE.Mesh(S.geoms.corpus,ee),n=new THREE.Mesh(S.geoms.diod,ne),i=new THREE.Group;return i.add(n,e),{plug:i,corpus:e,diod:n}},ae=function(){var e=new THREE.QuadraticBezierCurve3(new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,-1e3),new THREE.Vector3(0,0,-3500)),n=new THREE.TubeBufferGeometry(e,10,25,8,!1);return new THREE.Mesh(n,ee)},se=function(){if(0!=X.length){for(var e=0;e<X.length;e++){X[e].plug.remove(X[e].corpus),X[e].plug.remove(X[e].diod),$.remove(X[e].plug),$.remove(X[e].wire);X[e];X.splice(e,1),e--,null}C.remove($),X=[]}},le=.005,ue="DARK",de=function(e){0!=X.length&&("DARK"==e&&ce(),"FLASH"==e&&("DARK"==ue&&(fe(),ue="FLASH"),he()))},ce=function(){X.forEach(function(e){e.plug&&e.wire&&(e.wire.geometry.parameters.path.v2.x=5e3*Math.sin(I.rotation.y-.4),e.wire.geometry.dispose(),e.wire.geometry=new THREE.TubeBufferGeometry(e.wire.geometry.parameters.path,30,25,8,!1),e.wire.geometry.needsUpdate=!0)})},fe=function(){I.getWorldQuaternion($.quaternion),I.remove($),C.add($)},he=function(){ne.uniforms.light.value-=.01,le+=.6,X.forEach(function(e){e.plug.position.z-=le})},xe=function(){return 0==X.length||(!X[0].plug||X[0].plug.position.z<-5e3&&(se(),!0))},pe=[],ve=function(){for(var e=new THREE.MeshPhongMaterial({color:2024890,emissive:0,specular:12632256,shininess:100}),n=new THREE.CubeGeometry(600,600,600),i=0;i<20;i++)for(var t=0;t<20;t++){var r=new THREE.Mesh(n,e);C.add(r),r.position.set(600*t-6e3,600*i-3e3,-6e3),r.rotation.x=t/5+i/5,pe.push(r)}},Me=function(e){pe.forEach(function(e){e.rotation.x+=.01})},ge={dr01:{canvas:null,ctx:null,sprites:[],imgs:{back:{src:"assets/ill_01_back.png",data:null}}},dr02:{canvas:null,ctx:null,sprites:[],imgs:{back:{src:"assets/ill_02_back.png",data:null}}},dr03:{canvas:null,ctx:null,sprites:[],imgs:{back:{src:"assets/ill_03_back.png",data:null}}},dr04:{canvas:null,ctx:null,sprites:[],imgs:{back:{src:"assets/ill_04_back.png",data:null},wire:{src:"assets/ill_04_wire.png",data:null,x:0,y:0,x2:500,y2:400}}},dr05:{canvas:null,ctx:null,sprites:[],imgs:{back:{src:"assets/ill_05_back.png",data:null}}}},me={LeftNORMslow:{conus:1,spd:.6,start:{xMin:-20,xMax:-10,yMin:80,yMax:300},finish:{xMin:160,xMax:280,yMin:80,yMax:300},color:"#ff0"},LeftNORM:{conus:1,spd:1,start:{xMin:-20,xMax:-10,yMin:80,yMax:300},finish:{xMin:160,xMax:280,yMin:80,yMax:300},color:"#ff0"},RightBAD:{conus:1,spd:1,start:{xMin:310,xMax:320,yMin:185,yMax:187},finish:{xMin:500,xMax:510,yMin:110,yMax:230},color:"#fff"},LeftCONUS:{conus:1,spd:1,start:{xMin:-20,xMax:-10,yMin:80,yMax:300},finish:{xMin:160,xMax:280,yMin:150,yMax:205},color:"#ff0"},LeftCONUSred:{conus:1,spd:1,start:{xMin:-20,xMax:-10,yMin:80,yMax:300},finish:{xMin:160,xMax:280,yMin:130,yMax:235},color:"#f0f"},LeftCONUSgreen:{conus:1,spd:1,start:{xMin:-20,xMax:-10,yMin:80,yMax:300},finish:{xMin:160,xMax:280,yMin:130,yMax:235},color:"#0f0"},RightCONUS:{conus:1,spd:1,start:{xMin:320,xMax:330,yMin:150,yMax:205},finish:{xMin:500,xMax:510,yMin:80,yMax:300},color:"#ff0"},RightCONUSred:{conus:1,spd:1,start:{xMin:320,xMax:330,yMin:130,yMax:235},finish:{xMin:500,xMax:510,yMin:80,yMax:300},color:"#f0f"},RightCONUSgreen:{conus:1,spd:1,start:{xMin:320,xMax:330,yMin:130,yMax:235},finish:{xMin:500,xMax:510,yMin:80,yMax:300},color:"#0f0"},RightCONUSSuperSprT:{conus:1,spd:1,start:{xMin:325,xMax:330,yMin:120,yMax:170},finish:{xMin:500,xMax:510,yMin:80,yMax:150},color:"#0ff"},RightCONUSSuperSprB:{conus:1,spd:1,start:{xMin:325,xMax:330,yMin:240,yMax:270},finish:{xMin:500,xMax:510,yMin:220,yMax:310},color:"#0ff"},LeftCONUSSuperSprT:{conus:1,spd:1,start:{xMin:-20,xMax:-10,yMin:80,yMax:150},finish:{xMin:140,xMax:160,yMin:120,yMax:170},color:"#0ff"},LeftCONUSSuperSprB:{conus:1,spd:1,start:{xMin:-20,xMax:-10,yMin:220,yMax:310},finish:{xMin:140,xMax:160,yMin:240,yMax:270},color:"#0ff"},LinesVert:{conus:0,spd:.2,start:{xMin:-200,xMax:-30,yMin:0,yMax:0},finish:{xMin:600,xMax:600,yMin:0,yMax:0},color:"lineVert"},LinesHor:{conus:0,spd:.1,start:{xMin:0,xMax:0,yMin:800,yMax:900},finish:{xMin:0,xMax:0,yMin:-40,yMax:-60},color:"lineHor"}},we={LinesHor:{src:"assets/sprite_line_hor.png",data:null},LinesVert:{src:"assets/sprite_line_vert.png",data:null}},ye=[],Ee=0;window.onload=function(){n(function(){H(function(){b({canvas:document.getElementById("webgl"),w:window.innerWidth,h:.7*window.innerWidth},{canvas:document.getElementById("webgl_bottom"),w:window.innerWidth,h:.5*window.innerWidth}),g(),Ce(document.getElementById("webgl")),Ne(document.getElementById("preloader")),Te(w),Se(G)})})};var Re=void 0,Se=function(e){Re=e,window.addEventListener("resize",function(){Re({w:window.innerWidth,h:.7*window.innerWidth},{w:window.innerWidth,h:.5*window.innerWidth})},!1)},He=void 0,Te=function(e){He=e,document.addEventListener("wheel",be,!1),document.addEventListener("scroll",be,!1),document.addEventListener("touchstart",be,!1)},Le=function(){document.removeEventListener("wheel",be,!1),document.removeEventListener("scroll",be,!1),document.removeEventListener("touchstart",be,!1)},be=function(){He(),Le(),setTimeout(function(){document.getElementById("slogan").className="show"},500)},Ce=function(e){return e.className="show"},Ne=function(e){e.className="hide",setTimeout(function(){e.className="hidden"},1e3)}}();
