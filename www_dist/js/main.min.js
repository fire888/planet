!function(){"use strict";var e={uniforms:{red:{value:0},green:{value:.021},blue:{value:.04},tDiffuse:{value:null},light:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#ifdef GL_ES","precision mediump float;","#endif","uniform float red;","uniform float green;","uniform float blue;","uniform sampler2D tDiffuse;","uniform float light;","varying vec2 vUv;","float point (in vec2 uv, in vec2 center, in float radius) {","float len = length(center - uv);","return float(1. - smoothstep(radius, radius + .6, len));","}","void main() {","vec2 uv = vUv;","vec4 diff = texture2D(tDiffuse, uv);","vec2 tileuv = vec2(uv.x, uv.y*0.8) * 180.;","float radius = .03;","vec2 center = floor( tileuv ) + vec2( 0.5, 0.5 );","float point = point( tileuv, center, radius );","vec4 points = vec4( red + light, green + light, blue + light,  (1.01 - diff.y) * point );","vec4 contur = vec4( red + light, green + light, blue + light,  diff.x );","vec4 continents = vec4( red, green, blue, (1.5 - diff.y) * (1.0 - points.z) * 0.01 );","gl_FragColor = contur + continents + points;","}"].join("\n")},t={uniforms:{viewVector:{value:new THREE.Vector3(-800,-200,8200)},light:{value:.3},glowColor:{value:new THREE.Vector3(0,.24,.47)},border:{value:3.3}},vertexShader:["uniform vec3 viewVector;","uniform float light;","uniform float border;","varying float intensity;","void main() {","vec3 vNormal = normalize( normalMatrix * normal );","vec3 vNormel = normalize( normalMatrix * viewVector );","intensity = pow( abs(light) - dot(vNormal, vNormel), border );","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 glowColor;","uniform float light;","varying float intensity;","void main() {","vec3 glow = ( glowColor + light ) * intensity;","gl_FragColor = vec4( glow, 1.0 );","}"].join("\n")},n={uniforms:{color:{value:new THREE.Vector3(1.5,1.5,1.9)},light:{value:1}},vertexShader:["uniform float light;","void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float light;","uniform vec3 color;","void main() {","gl_FragColor = vec4( color * light, 1.0 );","}"].join("\n")},i=void 0,o=function(){var e=document.getElementById("app-webgl"),t=e.clientWidth||e.offsetWidth;return t>window.innerWidth&&(t=window.innerWidth),t},r=function(e){i=e,window.addEventListener("resize",function(){i(o())},!1)},a=void 0,l=function(e){a=e,document.addEventListener("wheel",u,!1),document.addEventListener("scroll",u,!1),document.addEventListener("touchstart",u,!1)},u=function(){a(),d(),setTimeout(function(){document.getElementById("slogan").className="show"},500)},d=function(){document.removeEventListener("wheel",u,!1),document.removeEventListener("scroll",u,!1),document.removeEventListener("touchstart",u,!1)},s=function(){document.getElementById("webgl").className="show"},c=function(){var e=document.getElementById("preloader");e.className="hide",setTimeout(function(){e.className="hidden"},1e3)};window.onload=function(){H(function(){var e=o();b(e),L(e),r(L),h(),le(),j(),q(),A(),s(),c(),l(g)})};var f,v=function(){this.earthRed=0,this.earthGreen=.04,this.earthBlue=.08,this.glowRed=0,this.glowGreen=.19,this.glowBlue=.22,this.glowLight=0,this.glowBorder=2.9,this.wireColor="#ffae23",this.wireDiodRed=.9,this.wireDiodGreen=.9,this.wireDiodBlue=.9,this.earthLeftMax=-2,this.earthRightMax=.45,this.earthAxell=85e-5,this.earthMaxSpd=.017,this.earthSpdFree=.015},h=function(){f=new v},m="DARK",g=function(){return m="FLASH"},E=function(){"FLASH"==m&&Z()&&re()&&(m="LIGHT"),C(m),te(m),ue(m)},w=void 0,p=void 0,R={textures:{waterNormals:null,continents:null},geoms:{corpus:null,diod:null}},H=function(e){w=new THREE.TextureLoader,p=new THREE.OBJLoader,new Promise(function(e){R.textures.continents=w.load("assets/contour.jpg",function(){e()})}).then(function(){return new Promise(function(e){p.load("assets/connector.obj",function(t){t.traverse(function(t){t instanceof THREE.Mesh==1&&("diod"==t.name&&(R.geoms.diod=t.geometry),"iron"==t.name&&(R.geoms.corpus=t.geometry),R.geoms.diod&&R.geoms.corpus&&e())})})})}).then(function(){w=null,p=null,e()})},T=void 0,M=void 0,x=void 0,y=void 0,S=void 0,b=function(e){x=new THREE.WebGLRenderer({canvas:document.getElementById("webgl")}),y=new THREE.WebGLRenderer({canvas:document.getElementById("webgl_bottom")}),M=new THREE.PerspectiveCamera(20,e/(.7*e),3.5,15e3),M.position.set(-800,-200,8200),S=M.clone(),S.position.set(0,0,8200);var t=new THREE.PointLight(252791645,.2);t.position.set(1e3,3e3,2e3);var n=new THREE.AmbientLight(9046131,.2);T=new THREE.Scene,T.add(t,n)},L=function(e){x.setSize(e,.7*e),M.aspect=e/(.7*e),M.updateProjectionMatrix(),y.setSize(e,.3*e),S.aspect=e/(.3*e),S.updateProjectionMatrix()},A=function e(){E(),x.render(T,M),"LIGHT"==m&&y.render(T,S),requestAnimationFrame(e)},G=void 0,D=void 0,B=void 0,j=function(){B=V(),D=F(),G=new THREE.Group,G.rotation.z=-.3,G.rotation.x=.5,D.rotation.y=.85,T.add(G.add(D),B)},F=function(){var t=new THREE.Mesh(new THREE.SphereGeometry(608,40,40),new THREE.ShaderMaterial(e));return t.material.transparent=!0,t.material.side=THREE.DoubleSide,t.material.depthWrite=!1,t.material.needsUpdate=!0,t.material.uniforms.tDiffuse.value=R.textures.continents,t},V=function(){var e=new THREE.Mesh(new THREE.SphereGeometry(780,40,40),new THREE.ShaderMaterial(t));return e.material.transparent=!0,e.material.blending=THREE.AdditiveBlending,e.material.side=THREE.DoubleSide,e.material.depthWrite=!1,e.material.needsUpdate=!0,e},P=.002,z="left",C=function(e){G&&("DARK"==e&&N(),"FLASH"==e&&W(),D.rotation.y+=P)},N=function(){D.rotation.y>f.earthLeftMax&&"left"==z&&(z="right"),D.rotation.y<f.earthRightMax&&"right"==z&&(z="left"),"left"==z&&Math.abs(P+f.earthAxell)<f.earthMaxSpd&&(P+=f.earthAxell),"right"==z&&Math.abs(P-f.earthAxell)<f.earthMaxSpd&&(P-=f.earthAxell)},W=function(){P<f.earthSpdFree?P+=3e-4:P=f.earthSpdFree,D.material.uniforms.light.value<1.35&&(D.material.uniforms.light.value+=.012),B.material.uniforms.light.value<.1&&(B.material.uniforms.light.value+=.0034)},Z=function(){return P==f.earthSpdFree},I=[],Y=[{dirY:6.08,dirZ:.8},{dirY:.2,dirZ:1.8},{dirY:3.24,dirZ:.8},{dirY:1.5,dirZ:.8},{dirY:1.9,dirZ:1.8},{dirY:3.7,dirZ:2}],_=void 0,U=void 0,K=void 0,q=function(){U=Q(),K=k(),_=new THREE.Group,Y.forEach(function(e){var t=J(),n=O();t.add(n);var i=new THREE.Group;i.add(t),i.position.set(Math.sin(e.dirZ)*Math.sin(e.dirY)*795,795*Math.cos(e.dirZ),Math.sin(e.dirZ)*Math.cos(e.dirY)*795),i.lookAt(0,0,0),I.push({connector:i,plug:t,wire:n}),_.add(i)}),D.add(_)},Q=function(){return new THREE.MeshPhongMaterial({color:789017,emissive:0,specular:16777215,shininess:100})},k=function(){return new THREE.ShaderMaterial(n)},J=function(){var e=new THREE.Mesh(R.geoms.corpus,U),t=new THREE.Mesh(R.geoms.diod,K),n=new THREE.Group;return n.add(t,e),n},O=function(){var e=new THREE.QuadraticBezierCurve3(new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,-1e3),new THREE.Vector3(0,0,-3500)),t=new THREE.TubeBufferGeometry(e,10,25,8,!1);return new THREE.Mesh(t,U)},X=function(){if(0!=I.length){for(var e=0;e<I.length;e++){_.remove(I[e].plug),_.remove(I[e].wire);I[e];I.splice(e,1),e--}T.remove(_),I=[]}},$=.005,ee="DARK",te=function(e){0!=I.length&&("DARK"==e&&ne(),"FLASH"==e&&("DARK"==ee&&(ie(),ee="FLASH"),oe()))},ne=function(){I.forEach(function(e){e.plug&&e.wire&&(e.wire.geometry.parameters.path.v2.x=5e3*Math.sin(D.rotation.y-.4),e.wire.geometry.dispose(),e.wire.geometry=new THREE.TubeBufferGeometry(e.wire.geometry.parameters.path,30,25,8,!1),e.wire.geometry.needsUpdate=!0)})},ie=function(){D.getWorldQuaternion(_.quaternion),D.remove(_),T.add(_)},oe=function(){K.uniforms.light.value-=.01,$+=.6,I.forEach(function(e){e.plug.position.z-=$})},re=function(){return 0==I.length||(!I[0].plug||I[0].plug.position.z<-5e3&&(X(),!0))},ae=[],le=function(){for(var e=new THREE.MeshPhongMaterial({color:2024890,emissive:0,specular:12632256,shininess:100}),t=new THREE.CubeGeometry(600,600,600),n=0;n<20;n++)for(var i=0;i<20;i++){var o=new THREE.Mesh(t,e);T.add(o),o.position.set(600*i-5e3,600*n-3e3,-6e3),o.rotation.x=i/5+n/5,ae.push(o)}},ue=function(e){ae.forEach(function(e){e.rotation.x+=.01})}}();
